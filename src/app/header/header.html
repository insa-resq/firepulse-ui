<nav class="navbar">
  <div class="title">ResQ</div>

  <div class="links">
    @if(isLoggedIn){
      <a routerLink="/detection" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Détection</a>
      <a routerLink="/planning" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Planning</a>
    }
  </div>

  <div class="auth-area">
    <!-- Non connecté -->
    @if(!isLoggedIn){
      <button class="auth-btn" (click)="login()">Connexion</button>
    }

    <!-- Connecté -->
    @if(isLoggedIn && userService.currentUser){
      <div class="user-menu">
        @if(userIcon){
            <div class="user-icon">
                <img src="{{ userIcon }}" alt="avatar"/>
            </div>
        }
        <button
          class="user-btn"
          type="button"
          (click)="menuOpen = !menuOpen"
          aria-haspopup="true"
          [attr.aria-expanded]="menuOpen">
          <img src="{{ userService.currentUser.avatarUrl }}" alt="avatar" />
        </button>

        @if(menuOpen){
          <ul class="dropdown" role="menu">
            <li role="menuitem">
              <a routerLink="/account" (click)="menuOpen = false">Compte</a>
            </li>
            @if (userService.isAdmin()) {
              <li role="menuitem">
              <a routerLink="/administration" (click)="menuOpen = false">Gérer</a>
            </li>
            }
            <li role="menuitem" (click)="logout()">Déconnexion</li>
          </ul>
        }
      </div>
    }
  </div>
</nav>
